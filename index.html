<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>M C company</title>
<style>
  /* Reset and base */
  * {box-sizing: border-box;}
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    color: #eee;
    min-height: 100vh;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }
  header {
    background: #1f1f1f;
    padding: 1rem;
    text-align: center;
    position: fixed;
    width: 100%;
    top: 0;
    left: 0;
    z-index: 1002;
    box-shadow: 0 2px 5px rgba(0,0,0,0.7);
    user-select: none;
  }
  header h1 {
    margin: 0;
    color: #ff3c3c;
    font-weight: 900;
    letter-spacing: 1.5px;
    font-size: 1.8rem;
  }
  .app-container {
    flex: 1;
    display: flex;
    overflow: hidden;
    height: 100%;
    max-height: 100vh;
    margin-top: 60px; /* space for header */
  }
  /* Sidebar styles */
  #sidebar {
    background: #1f1f1f;
    width: 220px;
    max-width: 80vw;
    height: calc(100vh - 60px);
    position: fixed;
    top: 60px; /* beneath header */
    left: 0;
    z-index: 1001;
    transform: translateX(0);
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
    padding: 1rem 1.2rem;
    user-select: none;
    box-shadow: 2px 0 8px rgba(255,60,60,0.5);
  }
  #sidebar.hidden {
    transform: translateX(-100%);
  }
  #sidebar h1 {
    font-size: 1.6rem;
    color: #ff3c3c;
    margin: 0 0 1.4rem 0;
    font-weight: 700;
    letter-spacing: 1.5px;
    user-select: none;
  }
  #sidebar nav {
    flex-grow: 1;
  }
  #sidebar nav ul {
    list-style: none;
    padding: 0;
    margin: 0 0 2rem 0;
  }
  #sidebar nav ul li {
    margin-bottom: 1.4rem;
  }
  #sidebar nav ul li button {
    background: none;
    border: none;
    color: #eee;
    font-size: 1.2rem;
    padding: 0;
    cursor: pointer;
    user-select: none;
    text-align: left;
    width: 100%;
    transition: color 0.3s ease;
    font-weight: 600;
  }
  #sidebar nav ul li button:hover,
  #sidebar nav ul li button.selected {
    color: #ff5c5c;
    outline: none;
  }
  #sidebar .languages {
    border-top: 1px solid #444;
    padding-top: 1rem;
  }
  #sidebar .languages h2 {
    font-size: 1.1rem;
    margin-bottom: 1rem;
    color: #ff6666;
    font-weight: 700;
    user-select: none;
  }
  #sidebar .languages ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  #sidebar .languages ul li {
    margin-bottom: 1rem;
  }
  #sidebar .languages ul li button {
    font-size: 1.05rem;
    color: #eee;
    background: none;
    border: none;
    cursor: pointer;
    transition: color 0.3s ease;
    width: 100%;
    text-align: left;
    padding: 0;
    font-weight: 600;
    user-select: none;
  }
  #sidebar .languages ul li button.selected {
    color: #ff3c3c;
    font-weight: 900;
    outline: none;
  }
  /* Close button inside sidebar */
  #sidebar-close-btn {
    align-self: flex-end;
    background: transparent;
    border: none;
    color: #ff3c3c;
    font-size: 1.6rem;
    cursor: pointer;
    padding: 0 0 0.75rem 0;
    user-select: none;
    transition: color 0.3s ease;
  }
  #sidebar-close-btn:hover,
  #sidebar-close-btn:focus {
    color: #ff1a1a;
    outline: none;
  }
  /* Hamburger toggle button */
  #toggle-btn {
    display: none;
    position: fixed;
    top: 14px;
    left: 14px;
    z-index: 2003;
    background: #ff3c3c;
    border: none;
    border-radius: 6px;
    width: 40px;
    height: 40px;
    cursor: pointer;
    box-shadow: 0 0 9px #ff3c3caa;
    user-select: none;
  }
  #toggle-btn:focus {
    outline: none;
    box-shadow: 0 0 14px #ff3c3cff;
  }
  #toggle-btn div {
    width: 22px;
    height: 3px;
    background: #fff;
    margin: 5px auto;
    border-radius: 2px;
    transition: 0.3s;
  }
  /* Animate toggle button when active */
  #toggle-btn.active div:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }
  #toggle-btn.active div:nth-child(2) {
    opacity: 0;
  }
  #toggle-btn.active div:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }
  /* Main content area */
  main {
    flex: 1;
    margin-left: 220px;
    padding: 1rem 1rem 2rem;
    overflow-y: auto;
    overflow-x: hidden;
    max-height: calc(100vh - 60px);
    display: flex;
    flex-direction: column;
    user-select: none;
    scroll-behavior: smooth;
  }
  main.fullwidth {
    margin-left: 0;
    max-width: 100%;
  }
  #search-container {
    margin-bottom: 1.2rem;
    text-align: center;
  }
  #search {
    width: 100%;
    max-width: 400px;
    padding: 0.6rem 0.9rem;
    border: none;
    border-radius: 10px;
    font-size: 1.1rem;
    outline: none;
    box-shadow: 0 0 8px #ff3c3c66;
    background: #222;
    color: #eee;
    transition: box-shadow 0.3s ease;
    font-weight: 600;
    user-select: text;
  }
  #search::placeholder {
    color: #bbb;
    font-weight: 400;
  }
  #search:focus {
    box-shadow: 0 0 14px #ff3c3ccc;
  }
  .section-header {
    margin: 1.8rem 0 1rem 0.5rem;
    font-size: 1.5rem;
    font-weight: 900;
    color: #ff4c4c;
    user-select: none;
    letter-spacing: 1.2px;
  }
  .items-scroll-container {
    display: flex;
    gap: 1.4rem;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding-bottom: 0.75rem;
    padding-left: 0.5rem;
    user-select: none;
  }
  .items-scroll-container::-webkit-scrollbar {
    height: 10px;
  }
  .items-scroll-container::-webkit-scrollbar-thumb {
    background: #ff3c3caa;
    border-radius: 6px;
  }
  .items-scroll-container::-webkit-scrollbar-track {
    background: #222;
  }
  .no-items-message {
    color: #999;
    text-align: center;
    width: 100%;
    user-select: none;
    font-size: 1.1rem;
    padding: 1rem 0;
    font-style: italic;
  }
  #error-message {
    color: #ff4c4c;
    text-align: center;
    padding: 1.2rem;
    font-weight: 700;
    user-select: none;
    font-size: 1.1rem;
  }
  footer {
    text-align: center;
    font-size: 0.85rem;
    padding: 0.75rem 1rem;
    color: #555;
    user-select: none;
    background-color: #111;
    flex-shrink: 0;
  }
  .movie-card, .series-card {
    flex: 0 0 180px;
    background: #222;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 15px #ff3c3caa;
    cursor: pointer;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    display: flex;
    flex-direction: column;
    user-select: none;
  }
  .movie-card:hover, .series-card:hover {
    transform: scale(1.12);
    box-shadow: 0 10px 30px #ff3c3ccc;
    z-index: 10;
    position: relative;
  }
  .poster {
    width: 100%;
    display: block;
    border-bottom: 1.5px solid #ff3c3c66;
    height: 270px;
    object-fit: cover;
    flex-shrink: 0;
    user-select: none;
    touch-action: manipulation;
  }
  .movie-info, .series-info {
    padding: 1rem 1.2rem 0.8rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }
  .movie-title, .series-title {
    font-weight: 900;
    font-size: 1.15rem;
    margin: 0 0 0.4rem;
    color: #ff5c5c;
    user-select: text;
  }
  .movie-genre, .series-genre {
    font-size: 0.85rem;
    color: #bbb;
    margin-bottom: 0.75rem;
    font-style: italic;
    user-select: text;
  }
  .movie-description, .series-description {
    font-size: 0.85rem;
    line-height: 1.3;
    color: #ccc;
    flex-grow: 1;
    user-select: text;
  }
  .download-btn {
    margin-top: 1rem;
    background: #ff3c3c;
    color: #fff;
    border: none;
    border-radius: 10px;
    padding: 0.6rem 0;
    font-size: 1rem;
    font-weight: 800;
    text-align: center;
    cursor: pointer;
    text-decoration: none;
    user-select: none;
    transition: background-color 0.3s ease, transform 0.15s ease;
    display: block;
    width: 100%;
    box-shadow: 0 3px 8px #ff3c3ccc;
  }
  .download-btn:hover,
  .download-btn:focus {
    background: #ff1a1a;
    outline: none;
    transform: scale(1.06);
    box-shadow: 0 6px 18px #ff1a1aee;
  }
  /* Responsive adjustments */
  @media (max-width: 900px) {
    #sidebar {
      width: 180px;
      padding: 1rem 1rem;
    }
    main {
      margin-left: 180px;
      max-width: calc(100vw - 180px);
      padding: 0.8rem 1rem 1.5rem;
    }
    .items-scroll-container {
      gap: 1rem;
      padding-left: 0.4rem;
    }
    .movie-card, .series-card {
      flex: 0 0 160px;
    }
    .poster {
      height: 240px;
    }
    #search {
      max-width: 280px;
      font-size: 1rem;
    }
    .section-header {
      font-size: 1.3rem;
      margin-left: 0.4rem;
    }
  }
  @media (max-width: 480px) {
    body {
      height: auto;
    }
    #sidebar {
      position: fixed;
      top: 60px;
      left: 0;
      height: calc(100vh - 60px);
      width: 250px;
      max-width: 80vw;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
      z-index: 2001;
      padding: 1rem 1.5rem;
      box-shadow: 2px 0 10px rgba(255,60,60,0.7);
    }
    #sidebar.show {
      transform: translateX(0);
    }
    main {
      margin-left: 0;
      max-width: 100vw;
      padding: 0.8rem 1rem 1.5rem;
      height: calc(100vh - 60px);
      overflow-y: auto;
    }
    #toggle-btn {
      display: block;
    }
    #sidebar-close-btn {
      display: block;
    }
    .movie-card, .series-card {
      flex: 0 0 140px;
    }
    .poster {
      height: 210px;
    }
    .items-scroll-container {
      gap: 0.8rem;
      padding-left: 0.3rem;
    }
    .section-header {
      font-size: 1.2rem;
      margin-left: 0.3rem;
    }
    #search {
      max-width: 90vw;
      font-size: 1.05rem;
      padding: 0.6rem 0.75rem;
    }
    footer {
      font-size: 0.8rem;
      padding: 0.75rem 1rem;
    }
  }
</style>
</head>
<body>
  <header>
    <h1> M C company</h1>
  </header>

  <button id="toggle-btn" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="sidebar" title="Toggle menu">
    <div></div>
    <div></div>
    <div></div>
  </button>

  <aside id="sidebar" role="navigation" aria-label="Main navigation">
    <button id="sidebar-close-btn" aria-label="Close navigation menu" title="Close menu">&times;</button>
    <nav>
      <ul>
        <li><button type="button" id="nav-movies" class="selected" aria-current="page">Movies</button></li>
        <li><button type="button" id="nav-series">Series</button></li>
      </ul>
    </nav>
    <div class="languages" aria-label="Select language">
      <h2>Language</h2>
      <ul>
        <li><button type="button" class="language-btn selected" data-lang="all">All</button></li>
        <li><button type="button" class="language-btn" data-lang="english">English</button></li>
        <li><button type="button" class="language-btn" data-lang="malayalam">Malayalam</button></li>
        <li><button type="button" class="language-btn" data-lang="tamil">Tamil</button></li>
        <li><button type="button" class="language-btn" data-lang="hindi">Hindi</button></li>
        <li><button type="button" class="language-btn" data-lang="telugu">Telugu</button></li>
      </ul>
    </div>
  </aside>

  <div class="app-container">
    <main>
      <div id="search-container">
        <input type="text" id="search" placeholder="Search movies..." aria-label="Search movies" autocomplete="off" />
      </div>
      <div id="error-message" role="alert" aria-live="assertive" style="display:none;"></div>

      <div id="movies-content">
        <section aria-label="Movies">
          <h2 class="section-header">Movies</h2>
          <div class="items-scroll-container" id="movies-container" tabindex="0" aria-live="polite" aria-relevant="additions removals"></div>
        </section>
      </div>

      <div id="series-content" style="display:none;">
        <section aria-label="Series">
          <h2 class="section-header">Series</h2>
          <div class="items-scroll-container" id="series-container" tabindex="0" aria-live="polite" aria-relevant="additions removals"></div>
        </section>
      </div>
    </main>
  </div>

  <footer>
    &copy; M©
  </footer>

  <script>
    const OMDB_API_KEY = '9b3b4fa1f1d85f3d1be4c5bb88a1b2c0'; // Replace with your OMDb API key

    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggle-btn');
    const navMoviesBtn = document.getElementById('nav-movies');
    const navSeriesBtn = document.getElementById('nav-series');
    const languageButtons = document.querySelectorAll('.language-btn');
    const searchInput = document.getElementById('search');
    const moviesContainer = document.getElementById('movies-container');
    const seriesContainer = document.getElementById('series-container');
    const errorMessageEl = document.getElementById('error-message');
    const moviesContent = document.getElementById('movies-content');
    const seriesContent = document.getElementById('series-content');
    const sidebarCloseBtn = document.getElementById('sidebar-close-btn');
    const searchContainer = document.getElementById('search-container');

    let currentCategory = 'movies';
    let currentLanguage = 'all';

    let moviesMinimal = [];
    let seriesMinimal = [];
    let moviesEnriched = [];
    let seriesEnriched = [];

    // Toggle sidebar for mobile
    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('show');
      toggleBtn.classList.toggle('active');
      let expanded = toggleBtn.getAttribute('aria-expanded') === 'true';
      toggleBtn.setAttribute('aria-expanded', !expanded);
    });

    sidebarCloseBtn.addEventListener('click', () => {
      sidebar.classList.remove('show');
      toggleBtn.classList.remove('active');
      toggleBtn.setAttribute('aria-expanded', 'false');
    });

    document.querySelector('main').addEventListener('click', () => {
      if (sidebar.classList.contains('show') && window.innerWidth <= 480) {
        sidebar.classList.remove('show');
        toggleBtn.classList.remove('active');
        toggleBtn.setAttribute('aria-expanded', 'false');
      }
    });

    // Category switching
    function switchCategory(cat) {
      if (currentCategory === cat) return;
      currentCategory = cat;
      searchInput.value = '';
      if (cat === 'movies') {
        moviesContent.style.display = '';
        seriesContent.style.display = 'none';
        navMoviesBtn.classList.add('selected');
        navMoviesBtn.setAttribute('aria-current', 'page');
        navSeriesBtn.classList.remove('selected');
        navSeriesBtn.removeAttribute('aria-current');
      } else {
        moviesContent.style.display = 'none';
        seriesContent.style.display = '';
        navSeriesBtn.classList.add('selected');
        navSeriesBtn.setAttribute('aria-current', 'page');
        navMoviesBtn.classList.remove('selected');
        navMoviesBtn.removeAttribute('aria-current');
      }
      currentLanguage = 'all';
      languageButtons.forEach(btn => btn.classList.toggle('selected', btn.dataset.lang === 'all'));
      errorMessageEl.style.display = 'none';
      searchContainer.style.display = '';
      searchInput.placeholder = currentCategory === 'movies' ? 'Search movies...' : 'Search series...';
      renderAll();
    }
    navMoviesBtn.addEventListener('click', () => switchCategory('movies'));
    navSeriesBtn.addEventListener('click', () => switchCategory('series'));

    // Language selection
    function setLanguage(lang) {
      currentLanguage = lang;
      languageButtons.forEach(btn => {
        btn.classList.toggle('selected', btn.dataset.lang === lang);
      });
      renderAll();
    }
    languageButtons.forEach(btn => btn.addEventListener('click', () => setLanguage(btn.dataset.lang)));

    // Fetch movie or series details from OMDb API by title
    async function fetchItemDetails(title, type = 'movie') {
      // type param optional for future extension (movie or series)
      const url = `https://www.omdbapi.com/?apikey=${OMDB_API_KEY}&t=${encodeURIComponent(title)}&type=${type}&plot=short`;
      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        if (data.Response === "False") throw new Error(`Not found: ${title}`);
        return {
          title: data.Title || title,
          genre: data.Genre || 'Unknown',
          description: data.Plot || 'No description available.',
          poster: (data.Poster && data.Poster !== 'N/A') ? data.Poster : 'https://via.placeholder.com/180x270?text=No+Image',
        };
      } catch (error) {
        console.warn('Fetch failed for', title, error);
        return {
          title,
          genre: 'Unknown',
          description: 'No description available.',
          poster: 'https://via.placeholder.com/180x270?text=No+Image',
        };
      }
    }

    // Load minimal JSON data from 'movies-data.json'
    async function loadDataMinimal() {
      try {
        const response = await fetch('movies-data.json', { cache: "no-store" });
        if (!response.ok) throw new Error(`Failed to load movies-data.json: ${response.statusText}`);
        const json = await response.json();
        moviesMinimal = json.movies || [];
        seriesMinimal = json.series || [];
        errorMessageEl.style.display = 'none';
      } catch (err) {
        console.error(err);
        errorMessageEl.textContent = 'Failed to load data. Please try again later.';
        errorMessageEl.style.display = 'block';
      }
    }

    // Enrich items array (movies or series)
    async function enrichItems(minimalArray, type = 'movie') {
      const enriched = [];
      for (const item of minimalArray) {
        const details = await fetchItemDetails(item.title, type);
        enriched.push({
          title: details.title,
          genre: details.genre,
          description: details.description,
          poster: details.poster,
          downloadUrl: item.downloadUrl,
          language: (item.language || 'all').toLowerCase()
        });
      }
      return enriched;
    }

    // Filter items by query and language
    function filterItems(items, query, lang) {
      let filtered = items;
      if (query) {
        const q = query.toLowerCase();
        filtered = filtered.filter(item =>
          item.title.toLowerCase().includes(q) ||
          item.genre.toLowerCase().includes(q) ||
          item.description.toLowerCase().includes(q)
        );
      }
      if (lang && lang !== 'all') {
        filtered = filtered.filter(item => item.language === lang);
      }
      return filtered;
    }

    // Display items in the container
    function displayItems(items, container, isSeries = false) {
      container.innerHTML = '';
      if (items.length === 0) {
        container.innerHTML = '<p class="no-items-message">No items found.</p>';
        return;
      }
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = isSeries ? 'series-card' : 'movie-card';
        card.tabIndex = 0;
        card.innerHTML = `
          <img src="${item.poster}" alt="${isSeries ? 'Poster of series ' : 'Poster of movie '}${item.title}" class="poster" loading="lazy" />
          <div class="${isSeries ? 'series-info' : 'movie-info'}">
            <h3 class="${isSeries ? 'series-title' : 'movie-title'}">${item.title}</h3>
            <div class="${isSeries ? 'series-genre' : 'movie-genre'}">${item.genre}</div>
            <p class="${isSeries ? 'series-description' : 'movie-description'}">${item.description}</p>
            <a href="${item.downloadUrl}" class="download-btn" download="${item.title.replace(/\s+/g, '_').toLowerCase()}.mp4" aria-label="Download ${item.title}">Download</a>
          </div>
        `;
        container.appendChild(card);
      });
    }

    // Render all items based on current category, language and search query
    function renderAll() {
      const query = searchInput.value.trim();
      if (currentCategory === 'movies') {
        moviesContent.style.display = '';
        seriesContent.style.display = 'none';
        const filteredMovies = filterItems(moviesEnriched, query, currentLanguage);
        displayItems(filteredMovies, moviesContainer);
      } else {
        moviesContent.style.display = 'none';
        seriesContent.style.display = '';
        const filteredSeries = filterItems(seriesEnriched, query, currentLanguage);
        displayItems(filteredSeries, seriesContainer, true);
      }
    }

    searchInput.addEventListener('input', renderAll);

    // Initialize app: load minimal data, enrich, and render default category
    async function init() {
      await loadDataMinimal();
      moviesEnriched = await enrichItems(moviesMinimal, 'movie');
      seriesEnriched = await enrichItems(seriesMinimal, 'series');
      renderAll();
    }

    init();
  </script>
</body>
</html>

