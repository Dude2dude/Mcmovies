<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>M C Company</title>
  <style>
    /* Your existing CSS goes here â€” unchanged */
  </style>
</head>
<body>
  <header>
    <h1> M C company</h1>
  </header>

  <button id="toggle-btn" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="sidebar" title="Toggle menu">
    <div></div>
    <div></div>
    <div></div>
  </button>

  <aside id="sidebar" role="navigation" aria-label="Main navigation">
    <button id="sidebar-close-btn" aria-label="Close navigation menu" title="Close menu">&times;</button>
    <nav>
      <ul>
        <li><button type="button" id="nav-movies" class="selected" aria-current="page">Movies</button></li>
        <li><button type="button" id="nav-series">Series</button></li>
      </ul>
    </nav>
    <div class="languages" aria-label="Select language">
      <h2>Language</h2>
      <ul>
        <li><button type="button" class="language-btn selected" data-lang="all">All</button></li>
        <li><button type="button" class="language-btn" data-lang="english">English</button></li>
        <li><button type="button" class="language-btn" data-lang="malayalam">Malayalam</button></li>
        <li><button type="button" class="language-btn" data-lang="tamil">Tamil</button></li>
        <li><button type="button" class="language-btn" data-lang="hindi">Hindi</button></li>
        <li><button type="button" class="language-btn" data-lang="telugu">Telugu</button></li>
      </ul>
    </div>
  </aside>

  <div class="app-container">
    <main>
      <div id="search-container">
        <input type="text" id="search" placeholder="Search movies or series..." aria-label="Search" autocomplete="off" />
      </div>
      <div id="error-message" style="display:none;"></div>

      <div id="list-view">
        <div id="movie-category-tabs">
          <button type="button" class="movie-category-btn selected" data-category="newReleases">New Released</button>
          <button type="button" class="movie-category-btn" data-category="mostlyWatched">Mostly Watched</button>
          <button type="button" class="movie-category-btn" data-category="trending">Trending</button>
          <button type="button" class="movie-category-btn" data-category="all">All</button>
        </div>

        <section>
          <h2 class="section-header" id="current-category-title">New Released</h2>
          <div class="items-scroll-container" id="movies-container"></div>
        </section>
      </div>

      <div id="detail-view" style="display:none;"></div>
    </main>
  </div>

  <footer>
    &copy; M&copy;
  </footer>

  <script>
  document.addEventListener('DOMContentLoaded', function () {
    const OMDB_API_KEY = '2a4113e';
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggle-btn');
    const navMoviesBtn = document.getElementById('nav-movies');
    const navSeriesBtn = document.getElementById('nav-series');
    const languageButtons = document.querySelectorAll('.language-btn');
    const searchInput = document.getElementById('search');
    const moviesContainer = document.getElementById('movies-container');
    const errorMessageEl = document.getElementById('error-message');
    const movieCategoryTabs = document.querySelectorAll('.movie-category-btn');
    const currentCategoryTitle = document.getElementById('current-category-title');
    const listView = document.getElementById('list-view');
    const detailView = document.getElementById('detail-view');
    const sidebarCloseBtn = document.getElementById('sidebar-close-btn');

    let currentView = 'movies';
    let currentCategory = 'newReleases';
    let currentLanguage = 'all';
    let moviesMinimal = [], seriesMinimal = [];
    let moviesEnriched = [], seriesEnriched = [];

    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('show');
      toggleBtn.classList.toggle('active');
      toggleBtn.setAttribute('aria-expanded', sidebar.classList.contains('show'));
    });

    sidebarCloseBtn.addEventListener('click', () => {
      sidebar.classList.remove('show');
      toggleBtn.classList.remove('active');
    });

    document.querySelector('main').addEventListener('click', () => {
      if (window.innerWidth <= 480) {
        sidebar.classList.remove('show');
        toggleBtn.classList.remove('active');
      }
    });

    navMoviesBtn.onclick = () => {
      currentView = 'movies';
      navMoviesBtn.classList.add('selected');
      navSeriesBtn.classList.remove('selected');
      renderItemsByCategory(currentCategory);
    };

    navSeriesBtn.onclick = () => {
      currentView = 'series';
      navSeriesBtn.classList.add('selected');
      navMoviesBtn.classList.remove('selected');
      renderItemsByCategory(currentCategory);
    };

    languageButtons.forEach(btn => btn.addEventListener('click', () => {
      currentLanguage = btn.dataset.lang;
      languageButtons.forEach(b => b.classList.toggle('selected', b.dataset.lang === currentLanguage));
      renderItemsByCategory(currentCategory);
    }));

    movieCategoryTabs.forEach(btn => btn.addEventListener('click', () => {
      renderItemsByCategory(btn.dataset.category);
    }));

    searchInput.addEventListener('input', () => {
      renderItemsByCategory(currentCategory);
    });

    async function fetchDetails(title) {
      try {
        const url = `https://www.omdbapi.com/?apikey=${OMDB_API_KEY}&t=${encodeURIComponent(title)}&plot=short`;
        const res = await fetch(url);
        const data = await res.json();
        return {
          title: data.Title || title,
          genre: data.Genre || 'Unknown',
          description: data.Plot || 'No description.',
          poster: (data.Poster && data.Poster !== 'N/A') ? data.Poster : 'https://via.placeholder.com/180x270?text=No+Image'
        };
      } catch {
        return {
          title,
          genre: 'Unknown',
          description: 'No description.',
          poster: 'https://via.placeholder.com/180x270?text=No+Image'
        };
      }
    }

    async function loadMinimalData() {
      const res = await fetch('movies-data.json');
      const data = await res.json();
      moviesMinimal = data.movies || [];
      seriesMinimal = data.series || [];
    }

    async function enrichData() {
      const enrich = async items => {
        const enriched = [];
        for (const item of items) {
          const d = await fetchDetails(item.title);
          enriched.push({
            title: d.title,
            genre: d.genre,
            description: d.description,
            poster: d.poster,
            downloadUrl: item.downloadUrl,
            language: item.language || 'all',
            category: item.category || 'all'
          });
        }
        return enriched;
      };
      moviesEnriched = await enrich(moviesMinimal);
      seriesEnriched = await enrich(seriesMinimal);
    }

    function renderItemsByCategory(category) {
      currentCategory = category;
      movieCategoryTabs.forEach(b => b.classList.toggle('selected', b.dataset.category === category));
      currentCategoryTitle.textContent = movieCategoryTabs.find(b => b.dataset.category === category)?.textContent || '';
      const items = currentView === 'movies' ? moviesEnriched : seriesEnriched;
      const filtered = items.filter(item =>
        (category === 'all' || item.category === category) &&
        (currentLanguage === 'all' || item.language === currentLanguage) &&
        (item.title.toLowerCase().includes(searchInput.value.toLowerCase()) ||
         item.genre.toLowerCase().includes(searchInput.value.toLowerCase()) ||
         item.description.toLowerCase().includes(searchInput.value.toLowerCase()))
      );
      displayItemsList(filtered);
    }

    function displayItemsList(items) {
      moviesContainer.innerHTML = '';
      if (items.length === 0) {
        moviesContainer.innerHTML = '<p class="no-items-message">No items found.</p>';
        return;
      }
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = currentView === 'movies' ? 'movie-card' : 'series-card';
        card.innerHTML = `
          <img src="${item.poster}" class="poster" alt="${item.title}" />
          <div class="${currentView}-info">
            <h3 class="${currentView}-title">${item.title}</h3>
            <div class="${currentView}-genre">${item.genre}</div>
            <p class="${currentView}-description">${item.description}</p>
            <a href="${item.downloadUrl}" class="download-btn" download="${item.title.replace(/\s+/g, '_').toLowerCase()}.mp4">Download</a>
          </div>`;
        card.onclick = () => showDetail(item);
        moviesContainer.appendChild(card);
      });
    }

    function showDetail(item) {
      listView.style.display = 'none';
      detailView.style.display = 'flex';
      detailView.innerHTML = `
        <img src="${item.poster}" class="detail-poster" />
        <h2>${item.title}</h2>
        <div class="detail-genre">${item.genre}</div>
        <div class="detail-description">${item.description}</div>
        <a href="${item.downloadUrl}" class="detail-download-btn" download="${item.title.replace(/\s+/g, '_').toLowerCase()}.mp4">Download</a>
        <button class="back-button">Back</button>`;
      detailView.querySelector('.back-button').onclick = () => {
        detailView.style.display = 'none';
        listView.style.display = '';
        searchInput.focus();
      };
    }

    async function init() {
      await loadMinimalData();
      await enrichData();
      renderItemsByCategory(currentCategory);
    }

    init();
  });
  </script>
</body>
</html>
